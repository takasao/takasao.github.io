
    <header>
      {% assign current_lang = page.lang | default: site.lang | default: 'en' %}

      {% if current_lang == 'ja' %}
        {% assign nav_items = "/ja/|トップ,/ja/cv/|CV,/ja/projects/|研究,/ja/presentations/|研究発表" | split: "," %}
      {% else %}
        {% assign nav_items = "/|Home,/cv/|CV,/projects/|Research,/presentations/|Presentations" | split: "," %}
      {% endif %}

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm {% if site.navbar_fixed %}fixed-top{% else %}sticky-top{% endif %}">
        <div class="container">
          {% if page.permalink != '/' -%}
          <a class="navbar-brand title font-weight-lighter" href="{{ site.baseurl }}/">
            {%- if site.title == "blank" -%}
              {%- if site.first_name -%}
                {{- site.first_name -}}&nbsp;
              {%- endif -%}
              {%- if site.middle_name -%}
                {{- site.middle_name -}}&nbsp;
              {%- endif -%}
              {%- if site.last_name -%}
                {{- site.last_name -}}
              {%- endif -%}
            {%- else -%}
              {{- site.title -}}
            {%- endif -%}
          </a>
          {%- elsif site.enable_navbar_social -%}
          <!-- Social Icons -->
          <div class="navbar-brand social">
            {% include social.html %}
          </div>
          {% endif %}

          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap align-items-center">
              {% for item in nav_items %}
                {% assign parts = item | split: "|" %}
                {% assign item_url = parts[0] %}
                {% assign item_label = parts[1] %}
                {% assign active = (page.url == item_url) or (page.permalink == item_url) %}
              <li class="nav-item {% if active %}active{% endif %}">
                <a class="nav-link" href="{{ item_url | relative_url }}">{{ item_label }}
                  {%- if active -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
                </a>
              </li>
              {% endfor %}

              <!-- Language buttons -->
              <li class="nav-item ml-sm-3">
                <div class="btn-group lang-toggle" role="group" aria-label="Language toggle">
                  <a class="btn btn-sm {% if current_lang == 'en' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="{{ '/' | relative_url }}">English</a>
                  <a class="btn btn-sm {% if current_lang == 'ja' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="{{ '/ja/' | relative_url }}">Japanese</a>
                </div>
              </li>

              {%- if site.enable_darkmode %}
              <!-- Toggle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
              {%- endif %}
            </ul>
          </div>
        </div>
      </nav>
{% if site.enable_progressbar %}
      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
{%- endif %}
    </header>
